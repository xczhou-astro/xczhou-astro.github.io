# Research

## Photometric Redshifts for Chinese Space Station Telescope
<h2 id="csst-photo-z"></h2>

We develop a redshift estimation pipeline using deep learning algorithms for Chines Space Station Telescope (CSST). This pipeline utilize multi-layer perceptron (MLP), convolutional neural network (CNN) and combination of these two networks, called Hybrid, to produce redshifts from photometric measurements, galaxy images, and combination of the two datasets. Some examples of galaxy images simulated based on HST:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/photo-z_CSST/galaxy_images_photoz_CSST.jpg" 
         width="800" 
         alt="CSST galaxy images">
    <p><em>Figure 1: CSST galaxy images simulated based on HST.</em></p>
</div>

The architecure of our networks are as follows:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/photo-z_CSST/Architecture_for_photoz.jpg" 
         width="800" 
         alt="Network architecture">
    <p><em>Figure 2: Architecture of networks for photometric redshift estimation.</em></p>
</div>

And for further improvement, transfer learning technique is employed for Hybrid network, leveraging the features tailored to photo-z. This network is referred as Hybrid transfer. The results for these four networks are as follows:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/photo-z_CSST/result_photoz_CSST.jpg" 
         width="800" 
         alt="Photo-z results">
    <p><em>Figure 3: Results of photometric redshift estimation using different network architectures.</em></p>
</div>

For consideration for uncertainties, we convert the networks to Bayesian neural networks. And the results are displayed as follow:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/photo-z_CSST/result_BNN_photoz_CSST.jpg" 
         width="800" 
         alt="BNN results">
    <p><em>Figure 4: Results of Bayesian neural networks for photometric redshift estimation.</em></p>
</div>

Associated codes are publicly available at <a href="https://github.com/xczhou-astro/CSST_photo_z_dl" target="_blank"><i class="fab fa-github"></i></a>

## Foreground Removal for CO Line Intensity Mapping
<h2 id="co-foreground"></h2>

We utilize U-Net to calibrate the deviation of power spectra induced by foreground removal of PCA. Foreground components include dust, synchrotron, spinning dust, free-free emission and CMB anisotropy generated by [PySM3](https://pysm3.readthedocs.io/en/latest/).

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/CO_foreground_removal/foregrounds.jpg" 
         width="800" 
         alt="Foreground components">
    <p><em>Figure 5: Different foreground components in CO intensity mapping.</em></p>
</div>

The calibration results by U-Net from different number of components PCA subtracts are displayed as follows:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/CO_foreground_removal/result_CO_foreground_removal.jpg" 
         width="800" 
         alt="Calibration results">
    <p><em>Figure 6: Calibration results using U-Net for different PCA components.</em></p>
</div>

## Redshift Estimation for CSST Slitless Spectroscopic Survey
<h2 id="csst-spec-z"></h2>

We build a 1d-convolutional neural network to estimate the spectroscopic redshifts from slitless spectra simulated based on DESI Legacy Surveys (DESI LS), DESI Early Data Release (DESI-EDR) and Baryon Oscillation Spectroscopic Survey (BOSS). The simulation software is publicly available at [GitLab](https://csst-tb.bao.ac.cn/code/zhangxin/sls_1d_spec). Two 2d spectral images and extracted 1d-spectra are displayed as follows:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/slitless_spec-z_CSST/2d_spectra_CSST.jpg" 
         width="800" 
         alt="2D spectra">
    <p><em>Figure 7: Examples of 2D slitless spectral images from CSST.</em></p>
</div>

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/slitless_spec-z_CSST/sls_examples.jpg" 
         width="800" 
         alt="1D spectra">
    <p><em>Figure 8: Examples of extracted 1D spectra</em></p>
</div>

Results for spectroscopic redshifts from slitless spectra:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/slitless_spec-z_CSST/sls_results.png" 
         width="800" 
         alt="Spec-z results">
    <p><em>Figure 9: Results of spectroscopic redshift estimation from slitless spectra. Left: CNN backbone, Right: BNN.</em></p>
</div>

Relevant codes are publicly available at <a href="https://github.com/xczhou-astro/CSST_slitless_spectra" target="_blank"><i class="fab fa-github"></i></a>

## DESI Photo-z Catalogue
<h2 id="desi-photo-z"></h2>

We utilize Bayesian neural networks built upon Multiplicative Normalizing Flows ([MNF](https://github.com/janosh/tf-mnf)) to estimate photometric redshifts for sources in DESI Legacy Surveys. To enhance the accuracy, the sources are categorized into four groups, Bright Galaxy Sample (BGS), Luminous Red Galaxies (LRG), Emission Line Galaxies (ELG) and a group including the remaining sources, referred as NON, based on their characteristics by DESI target selections. Four networks are trained separately using galaxy images in 3 optical bands from DESI LS and 2 infrared bands from WISE and corresponding spectroscopic redshifts from the DESI early data release (DESI-EDR), leveraging the high quality and accurate measurements of spec-z by DESI.

Results for these four groups:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/DESI_photo-z/DESI_z_result.jpg" 
         width="800" 
         alt="DESI results">
    <p><em>Figure 10: Results of photometric redshift estimation for different DESI target groups.</em></p>
</div>

Additionally, UMAP is employed to investigate the deeper cause for the distinct behaviors for these groups:

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/DESI_photo-z/DESI_EDR_feature_space.png" 
         width="800" 
         alt="UMAP visualization">
    <p><em>Figure 11: UMAP visualization of feature space for different DESI target groups.</em></p>
</div>

Correlations exist between the reduced 2d positions and redshifts for BGS and LRG. Contrary, correlations are less pronounced for ELG. Interestingly, NON is divided to 2 parts, with one resembling the ELG, and the other one having good correlations. These two parts can be divided using z < 21.3. Finally, we create a new photo-z catalogue for BGS, LRG and NON with z < 21.3, considering the performance. This catalogue is publicly available at [here](https://pan.cstcloud.cn/web/share.html?hash=hUWwk1QTSjo). 

Note that our results are limited by the data size of DESI-EDR. With future releases, we plan to refine and update our catalogue.

## Preliminary Target Selection for MUltiplexed Spectroscopic Telescope (MUST)
<h2 id="must-target-selection"></h2>

With my knowledge in photometric and spectroscopic data analysis, I have been working on preliminary target selection for MUST, a stage-V spectroscopic instrument led by Tsinghua University. I am currently in charge of Emission Line Galaxies (ELG) and high-redshift Lyman Break Galaxies (LBG) under the observational conditions of MUST. Additionally, I calculate the galaxy bias for the capability of cosmological constraints. And currently, I am engaged in spectra simulation, using my knowledge from slitless spectra for CSST. 

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/target_selection/Preliminary_Target_Selection.jpg" 
         width="800" 
         alt="Preliminary target selection">
    <p><em>Figure 12: Preliminary target selection for MUST. Credit: arXiv: <a href="https://arxiv.org/abs/2411.07970">2411.07970</a></em></p>
</div>

## galaxyGenius
<h2 id="galaxygenius"></h2>

Galaxy can be emulated using magneto-hydrodynamical simulations by assigning each particle with a SED using radiative transfer code, instead of adopting empirical method, such as Halo occupation distributions (HODs).  

We build a Python wrapper to emulate galaxies, involving complete routine from preprocessing to postprocessing, from IllustrisTNG using SKIRT. Preprocessing extracts stellar and dust particles from IllustrisTNG, assigns SED to them by astronomical parameters, such as mass, metallicity and so on, and executes the SKIRT code. On the other hand, postprocessing applies instrumental and observational effects, including point spread functions (PSFs) and background noises for specific instruments.  

This project serves as the foundations for addressing other interesting works including deblending analysis and galaxy parameter estimations.  

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/galaxyGenius/SEDs.png" 
         width="800" 
         alt="Galaxy emulation">
    <p><em>Figure 13: Generated SEDs of Subhalo 0, 31, and 253881 from TNG-100.</a></em></p>
</div>

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/galaxyGenius/CSST_combined.png" 
         width="800" 
         alt="Galaxy emulation">
    <p><em>Figure 14: Generated galaxy images for CSST.</a></em></p>
</div>

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="figures/galaxyGenius/JWST_combined.png" 
         width="800" 
         alt="Galaxy emulation">
    <p><em>Figure 15: Generated galaxy images for JWST NIRCam.</a></em></p>
</div>

Our code is publicly available at <a href="https://github.com/xczhou-astro/galaxyGenius" target="_blank"><i class="fab fa-github"></i></a>, and relevant paper is still drafting. 