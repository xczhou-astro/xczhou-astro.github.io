# Research

## Photometric Redshifts for Chinese Space Station Telescope

We develop a redshift estimation pipeline using deep learning algorithms for Chines Space Station Telescope (CSST). This pipeline utilize multi-layer perceptron (MLP), convolutional neural network (CNN) and combination of these two networks, called Hybrid, to produce redshifts from photometric measurements, galaxy images, and combination of the two datasets. Some examples of galaxy images simulated based on HST:

![Result](figures/photo-z_CSST/galaxy_images_photoz_CSST.jpg)

The architecure of our networks are as follows:

![Result](figures/photo-z_CSST/Architecture_for_photoz.jpg)

And for further improvement, transfer learning technique is employed for Hybrid network, leveraging the features tailored to photo-z. This network is referred as Hybrid transfer. The results for these four networks are as follows:

![Result](figures/photo-z_CSST/result_photoz_CSST.jpg)

For consideration for uncertainties, we convert the networks to Bayesian neural networks. And the results are displayed as follow:

![Result](figures/photo-z_CSST/result_BNN_photoz_CSST.jpg)

Associated codes are publicly available at [Github](https://github.com/xczhou-astro/CSST_photo_z_dl).

## Foreground Removal for CO Line Intensity Mapping

We utilize U-Net to calibrate the deviation of power spectra induced by foreground removal of PCA. Foreground components include dust, synchrotron, spinning dust, free-free emission and CMB anisotropy generated by [PySM3](https://pysm3.readthedocs.io/en/latest/).

![foregrounds](figures/CO_foreground_removal/foregrounds.jpg)

The calibration results by U-Net from different number of components PCA subtracts are displayed as follows:

![results](figures/CO_foreground_removal/result_CO_foreground_removal.jpg)

## Redshift Estimation for CSST Slitless Spectroscopic Survey

We build a 1d-convolutional neural network to estimate the spectroscopic redshifts from slitless spectra simulated based on DESI Legacy Surveys (DESI LS), DESI Early Data Release (DESI-EDR) and Baryon Oscillation Spectroscopic Survey (BOSS). The simulation software is publicly available at [GitLab](https://csst-tb.bao.ac.cn/code/zhangxin/sls_1d_spec). Two 2d spectral images and extracted 1d-spectra are displayed as follows:

![spectra](figures/slitless_spec-z_CSST/2d_spectra_CSST.jpg)
![spectra](figures/slitless_spec-z_CSST/sls_examples.jpg)

Results for spectroscopic redshifts from slitless spectra:

![result](figures/slitless_spec-z_CSST/result_spec-z.jpg)

Relevant codes are publicly available at [Github](https://github.com/xczhou-astro/CSST_slitless_spectra)

## DESI Photo-z Catalogue

We utilize Bayesian neural networks built upon Multiplicative Normalizing Flows ([MNF](https://github.com/janosh/tf-mnf)) to estimate photometric redshifts for sources in DESI Legacy Surveys. To enhance the accuracy, the sources are categorized into four groups, Bright Galaxy Sample (BGS), Luminous Red Galaxies (LRG), Emission Line Galaxies (ELG) and a group including the remaining sources, referred as NON, based on their characteristics by DESI target selections. Four networks are trained separately using galaxy images in 3 optical bands from DESI LS and 2 infrared bands from WISE and corresponding spectroscopic redshifts from the DESI early data release (DESI-EDR), leveraging the high quality and accurate measurements of spec-z by DESI.

Results for these four groups:

![result](figures/DESI_photo-z/DESI_z_result.jpg)

Additionally, UMAP is employed to investigate the deeper cause for the distinct behaviors for these groups:

![umap](figures/DESI_photo-z/DESI_EDR_feature_space.png)

Correlations exist between the reduced 2d positions and redshifts for BGS and LRG. Contrary, correlations are less pronounced for ELG. Interestingly, NON is divided to 2 parts, with one resembling the ELG, and the other one having good correlations. These two parts can be divided using z < 21.3. Finally, we create a new photo-z catalogue for BGS, LRG and NON with z < 21.3, considering the performance. This catalogue is publicly available at [here](https://pan.cstcloud.cn/web/share.html?hash=hUWwk1QTSjo). 

Note that our results are limited by the data size of DESI-EDR. With future releases, we plan to refine and update our catalogue. 

## Preliminary Target Selection for MUltiplexed Spectroscopic Telescope (MUST)

With my knowledge in photometric and spectroscopic data analysis, I have been working on preliminary target selection for MUST, a stage-V spectroscopic instrument led by Tsinghua University. I am currently in charge of Emission Line Galaxies (ELG) and high-redshift Lyman Break Galaxies (LBG) under the observational conditions of MUST. Additionally, I calculate the galaxy bias for the capability of cosmological constraints. And currently, I am engaged in spectra simulation, using my knowledge from slitless spectra for CSST. 

## galaxyEmulator

Galaxy can be emulated using magneto-hydrodynamical simulations by assigning each particle with a SED using radiative transfer code, instead of adopting empirical method, such as Halo occupation distributions (HODs).  

We build a Python wrapper to emulate galaxies, involving complete routine from preprocessing to postprocessing, from IllustrisTNG using SKIRT. Preprocessing extracts stellar and dust particles from IllustrisTNG, assigns SED to them by astronomical parameters, such as mass, metallicity and so on, and executes the SKIRT code. On the other hand, postprocessing applies instrumental and observational effects, including point spread functions (PSFs) and background noises for specific instruments.  

This project serves as the foundations for addressing other interesting works including deblending analysis and galaxy parameter estimations.  

Our code is publicly available at [Github](https://github.com/xczhou-astro/galaxyEmulator) and relevant paper is still drafting. 